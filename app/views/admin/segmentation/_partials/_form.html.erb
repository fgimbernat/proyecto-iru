<%# Partial para el formulario de segmentación (crear/editar) %>
<%# Uso: render 'partials/form', form_url: path, segmentation: seg_or_nil, x_model_prefix: 'new' %>

<%= form_with url: local_assigns[:form_url], method: local_assigns[:method] || :post do |f| %>
  <%# Campo Nombre %>
  <div class="mb-4">
    <label for="<%= local_assigns[:field_id_prefix] %>_name" class="block text-sm font-medium text-gray-700 mb-2">
      Nombre
    </label>
    <%= f.text_field :name, 
        id: "#{local_assigns[:field_id_prefix]}_name",
        value: local_assigns[:segmentation]&.name,
        'x-model': "#{local_assigns[:x_model_prefix]}Name",
        class: "block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm", 
        placeholder: "Ingresa el nombre", 
        required: true %>
  </div>

  <%# Campo Visibilidad %>
  <div class="mb-4">
    <label for="<%= local_assigns[:field_id_prefix] %>_visibility" class="block text-sm font-medium text-gray-700 mb-2">
      Visibilidad
      <%= render 'partials/icons/info' %>
    </label>
    <div class="relative">
      <%= f.select :visibility, 
          Segmentation::VISIBILITY_OPTIONS,
          { selected: local_assigns[:segmentation]&.visibility || 'all' },
          id: "#{local_assigns[:field_id_prefix]}_visibility",
          'x-model': "#{local_assigns[:x_model_prefix]}Visibility",
          class: "block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm appearance-none bg-white pr-10" %>
      <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
        <%= render 'partials/icons/chevron_down' %>
      </div>
    </div>
    <p class="mt-2 text-xs text-gray-500">Determina quién verá este campo en el perfil del usuario</p>
  </div>

  <%# Footer con botones %>
  <div class="bg-gray-50 px-6 py-4 flex items-center justify-end space-x-3 -mx-6 -mb-4 mt-6">
    <button @click="<%= local_assigns[:cancel_action] %>" 
            type="button" 
            class="px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors">
      Cancelar
    </button>
    
    <%= f.submit local_assigns[:submit_text] || "Guardar", 
        class: "px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors" %>
  </div>
<% end %>
