<div class="user-form-container">
  <%= form_with(model: [:admin, user], local: true) do |f| %>
    <!-- Errores del formulario -->
    <% if user.errors.any? %>
      <div style="margin-bottom: 24px;">
        <%= render AlertComponent.new(type: :error, dismissible: false) do %>
          <h3 class="text-sm font-medium mb-2">
            <%= pluralize(user.errors.count, "error") %> impidieron guardar este usuario:
          </h3>
          <ul class="list-disc pl-5 space-y-1 text-sm">
            <% user.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        <% end %>
      </div>
    <% end %>

    <div class="user-form-grid">
      <!-- Sidebar: Informaci칩n B치sica -->
      <div>
        <%= render 'form_sidebar', f: f, user: user %>
      </div>

      <!-- Main: Tabs de Informaci칩n -->
      <div>
        <div x-data="{ activeTab: 'general' }" class="user-form-main">
          <!-- Tabs Navigation -->
          <nav class="form-tabs-nav">
            <button 
              type="button" 
              @click="activeTab = 'general'" 
              :class="activeTab === 'general' ? 'active' : ''" 
              class="tab-btn">
              General
            </button>
            <button 
              type="button" 
              @click="activeTab = 'segmentacion'" 
              :class="activeTab === 'segmentacion' ? 'active' : ''" 
              class="tab-btn">
              Segmentaci칩n
            </button>
            <button 
              type="button" 
              @click="activeTab = 'permisos'" 
              :class="activeTab === 'permisos' ? 'active' : ''" 
              class="tab-btn">
              Permisos
            </button>
          </nav>

          <!-- Tab Content -->
          <div class="form-tabs-content">
            <%= render 'form_tab_general', f: f, user: user %>
            <%= render 'form_tab_segmentacion', f: f %>
            <%= render 'form_tab_permisos', f: f, user: user %>
          </div>
        </div>
      </div>
    </div>

    <!-- Acciones -->
    <div class="form-actions">
      <%= link_to "Cancelar", admin_users_path, class: "btn btn--ghost btn--md" %>
      <%= f.submit "Guardar", class: "btn btn--primary btn--md" %>
    </div>
  <% end %>
</div>
